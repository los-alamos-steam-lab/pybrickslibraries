# pybricks blocks file:{"blocks":{"languageVersion":0,"blocks":[{"type":"blockGlobalSetup","id":"bjK,wS1MYO7aiYkFSwd{","x":16,"y":-8,"deletable":false,"next":{"block":{"type":"variables_set_inventor_hub","id":"{PfnO/^^7jbE|:YQqv0_","extraState":{"optionLevel":0},"fields":{"VAR":{"id":"*5#BC_CDLI:7,Tq%_{#f"}},"next":{"block":{"type":"variables_setup_imported_function","id":"giC/s|xX/K+.WCijR:zo","fields":{"FROM_MODULE":{"id":"675Tewb-hZRNskTpaPR^"},"VAR":{"id":"Sffa}}200*Q_|`ua!5IE"}},"next":{"block":{"type":"variables_setup_imported_function","id":"=}XV0~`:H4uDYYfl-:pP","fields":{"FROM_MODULE":{"id":"675Tewb-hZRNskTpaPR^"},"VAR":{"id":"NdzekE#*A-3^u{=XF,9y"}},"next":{"block":{"type":"variables_setup_imported_function","id":"$N9wYz5Ei.nBnb!s-E4`","fields":{"FROM_MODULE":{"id":"675Tewb-hZRNskTpaPR^"},"VAR":{"id":"InaCEX!Wvubx{)h9ua7L"}},"next":{"block":{"type":"variables_setup_imported_function","id":"9de-bU,Q93MJsx-Ws-@H","fields":{"FROM_MODULE":{"id":"675Tewb-hZRNskTpaPR^"},"VAR":{"id":"H)(CPxdW.NkK~=wz;ku{"}},"next":{"block":{"type":"variables_setup_imported_function","id":"OmOGV]+h9YF6;e({M0qo","fields":{"FROM_MODULE":{"id":"675Tewb-hZRNskTpaPR^"},"VAR":{"id":"LB$!O#z=:D;Ve=[[[MyW"}},"next":{"block":{"type":"variables_setup_any","id":".i]KE~yO`yx2nb$dJ^UD","fields":{"VAR":{"id":"7)~un:z)5e}=.]Wk?bCp"}},"inputs":{"VALUE0":{"shadow":{"type":"blockMathNumber","id":"kRDg[]2Jjl/I7$iGo{u;","fields":{"NUM":0}},"block":{"type":"blockImportTaskCallValue","id":"WbkBvd[VGI-zG7LbS$ub","extraState":{"optionLevel":0},"inputs":{"VAR":{"shadow":{"type":"variables_get_imported_function","id":"g,noa/6jb8V.:Da5`;2c","fields":{"VAR":{"id":"Sffa}}200*Q_|`ua!5IE","name":"DuploTrain","type":"FunctionImported"}}}}}}}},"next":{"block":{"type":"variables_set_motor","id":"fEi2x[#OqUMq5sguv5Z@","fields":{"VAR":{"id":"A%Q4I{Fw1}[HZ25D/7sC"}},"inputs":{"PORT":{"shadow":{"type":"blockParametersPort","id":"kEO(A/bs@Lb*g_AUK5=V","fields":{"NAME":"A"}}},"POSITIVE_DIRECTION":{"shadow":{"type":"blockParametersDirection","id":"kTOtk9n{hKY+nkHvu?-9","fields":{"SELECTION":"Direction.CLOCKWISE"}}}},"next":{"block":{"type":"variables_set_color_sensor","id":"c4VL[.L{UcjlqM%/+444","extraState":{"optionLevel":0},"fields":{"VAR":{"id":"@XZHI/7H?CTN~buGAy24"}},"inputs":{"PORT":{"shadow":{"type":"blockParametersPort","id":"^M]_hxv]hYHjrInqKNyu","fields":{"NAME":"F"}}}},"next":{"block":{"type":"variables_setup_any","id":"xZ=xm5c$ni1qJiu))M;R","fields":{"VAR":{"id":"TE4wo///`0hS0R{cxKph"}},"inputs":{"VALUE0":{"shadow":{"type":"blockMathNumber","id":"/9!vjomG]9jBNf*^R9yi","fields":{"NUM":0}},"block":{"type":"variables_get_color","id":"bhS6p](@/d$]^Nq+/@{i","fields":{"COLOUR":"#000000","VAR":{"id":"TFmFW?).wKf=+rwisHES"}}}}},"next":{"block":{"type":"variables_setup_any","id":":z^;f3A`sL0$!(3*8!w)","fields":{"VAR":{"id":"zU|zw|^jx16lQDrMxQ!}"}},"inputs":{"VALUE0":{"shadow":{"type":"blockMathNumber","id":"Ag*vwn/;3P0FH0tk[|BM","fields":{"NUM":0}},"block":{"type":"variables_get_color","id":"4ZhQ:bMim8)I~,u51sGU","fields":{"COLOUR":"#000000","VAR":{"id":"TFmFW?).wKf=+rwisHES"}}}}},"next":{"block":{"type":"variables_setup_any","id":"s(2!s`*s.vB}q(#uP:B|","fields":{"VAR":{"id":"Et2W!b}zsYFYxI[Se.}N"}},"inputs":{"VALUE0":{"shadow":{"type":"blockMathNumber","id":"I+S}o*$ZhlvqWR:gq03}","fields":{"NUM":0}},"block":{"type":"blockNone","id":",)H[7Yz6X_52}VKro6E/"}}},"next":{"block":{"type":"variables_setup_any","id":"oS)j(_[}~Tz@3#D`D=hn","fields":{"VAR":{"id":"xrrSdt#dhf(z@N_OqNbl"}},"inputs":{"VALUE0":{"shadow":{"type":"blockMathNumber","id":"?NZIDE2g=m)]|SKumV(?","fields":{"NUM":0}},"block":{"type":"blockNone","id":"$8-wZ5i#fLB(e=H-oRZ;"}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},{"type":"blockGlobalStart","id":"3tJe|AWl0baN(wH9a$@.","x":0,"y":799,"deletable":false,"next":{"block":{"type":"blockMotorResetAngle","id":"X005$lM;]ER|){rxF@Hb","inputs":{"VAR":{"shadow":{"type":"variables_get_motor_device","id":"=UI5iQJ$4FQQL;=e`M2=","fields":{"VAR":{"id":"A%Q4I{Fw1}[HZ25D/7sC","name":"dial","type":"Motor"}}}},"VALUE0":{"shadow":{"type":"unit_angle","id":"TR?=F+tC]E1wvLmcvxMT","fields":{"VALUE0":0}}}},"next":{"block":{"type":"blockComment","id":"cE%o[V2hg4*n#9aiXhHx","fields":{"FIELDNAME":"My youngest would often press the hub button. This\nnormally stops the program, so it interrupts the fun\nof just playing and independently exploring.\n\nThis block disables that, so the program doesn't stop.\nIf you do want to stop eventually, just hold the button\nto turn the hub off entirely, as you normally would."},"next":{"block":{"type":"blockHubStopButton","id":"hcI!/Ho0c.Dcq=lU`rrq","inputs":{"VAR":{"shadow":{"type":"variables_get_button_hub","id":"H.D:DDKpPt1URrl`G/wf","fields":{"VAR":{"id":"*5#BC_CDLI:7,Tq%_{#f","name":"inventor hub","type":"InventorHub"}}}},"VALUE0":{"shadow":{"type":"blockParametersButton","id":",~Vh82WirQz;@W9Sn.BF","fields":{"VALUE":"BLUETOOTH"}}}},"next":{"block":{"type":"blockFlowWhile","id":"kNA3Ql:gd,YZ~o`U3HFf","fields":{"MODE":"WHILE"},"inputs":{"BOOL":{"shadow":{"type":"blockLogicTrue","id":"~PrquIN`#DE76x;sQT,-"}},"DO":{"block":{"type":"blockComment","id":"_B]B5L(Tv|hS7!yHK^rb","fields":{"FIELDNAME":"Set the train speed based on the motor angle."},"next":{"block":{"type":"blockImportTaskCallStatement","id":"?d_^.Nlq_c]::q7V{KIz","extraState":{"optionLevel":2},"inputs":{"VAR":{"shadow":{"type":"variables_get_imported_function","id":"dVbN@gwIxP7;89X-.y,5","fields":{"VAR":{"id":"NdzekE#*A-3^u{=XF,9y","name":"start_driving","type":"FunctionImported"}}}},"ARG0":{"shadow":{"type":"blockMathNumber","id":"]5lS8{~;tRFE{simAu2c","fields":{"NUM":0}},"block":{"type":"blockVariableGetValue","id":"$Z9-RoAZ@-X)XvEHA8Yl","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"188iblNXCJ}oVeq=gsl@","fields":{"VAR":{"id":"7)~un:z)5e}=.]Wk?bCp","name":"train1","type":"Any"}}}}}}},"ARG1":{"shadow":{"type":"blockMathNumber","id":"`BBF3}YHJAf[ME7lknWP","fields":{"NUM":0}},"block":{"type":"blockMotorMeasure","id":"v(MsO;0F/c%4Xx)Uz3`A","extraState":{"optionLevel":1},"fields":{"METHOD":"MOTOR_ANGLE"},"inputs":{"VAR":{"shadow":{"type":"variables_get_motor_device","id":"Y1SL3[?DJUfr.m#yv.!u","fields":{"VAR":{"id":"A%Q4I{Fw1}[HZ25D/7sC","name":"dial","type":"Motor"}}}}}}}},"next":{"block":{"type":"blockComment","id":"KW3S)7[n{X/r,=1LhFQI","fields":{"FIELDNAME":"Play a sound if the hub button is pressed."},"next":{"block":{"type":"blockIfElse","id":"v)^9}@2LrGx`b|I4dK~v","extraState":{"optionLevel":0},"inputs":{"IF0":{"shadow":{"type":"blockLogicTrue","id":"zI0~8[`K2E?PqjnS*1o8"},"block":{"type":"blockButtonIsPressed","id":"=Yr:J3Co*%D|AYy-:cZQ","inputs":{"VAR":{"shadow":{"type":"variables_get_keypad","id":"aXy%S3*+fY.oF#1j@ZUA","fields":{"VAR":{"id":"*5#BC_CDLI:7,Tq%_{#f","name":"inventor hub","type":"InventorHub"}}}},"VALUE0":{"shadow":{"type":"blockParametersButton","id":"[p#wDekt^|~_$x{/VV*h","fields":{"VALUE":"CENTER"}}}}}},"DO0":{"block":{"type":"blockImportTaskCallStatement","id":"n$-RekZ{=^Cr-,smU#8?","extraState":{"optionLevel":2},"inputs":{"VAR":{"shadow":{"type":"variables_get_imported_function","id":"{nG?[vNSEQ.AX+{A$%r%","fields":{"VAR":{"id":"InaCEX!Wvubx{)h9ua7L","name":"play_sound","type":"FunctionImported"}}}},"ARG0":{"shadow":{"type":"blockMathNumber","id":"k*kN}}Ni!gyWAr#OsKen","fields":{"NUM":50}},"block":{"type":"blockVariableGetValue","id":"{zaWnV+o$.e$z=AQB`rT","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"a|cXV.~[IiS?f[:JGmVA","fields":{"VAR":{"id":"7)~un:z)5e}=.]Wk?bCp","name":"train1","type":"Any"}}}}}}},"ARG1":{"shadow":{"type":"blockMathNumber","id":"B%d#N@tor?Fdx;7!2uYP","fields":{"NUM":0}},"block":{"type":"blockTextLiteral","id":"])tK^}]`!$YeGCh-HG4;","fields":{"TEXT":"depart"}}}},"next":{"block":{"type":"blockWaitUntil","id":"%CH{0LJ5NU-#wL)rBnOE","inputs":{"BOOL":{"shadow":{"type":"blockLogicTrue","id":"f!B]ND?BM^EcCiOCs0k,"},"block":{"type":"blockLogicIsNone","id":"vs*d88oa_V-HhQI1-F;N","fields":{"OP":"NOT"},"inputs":{"BOOL":{"shadow":{"type":"blockLogicTrue","id":"O5)5@ZgrGO^u7^@:o[7O"},"block":{"type":"blockButtonIsPressed","id":"CMj05}Z/{EB*N|oKYD8$","inputs":{"VAR":{"shadow":{"type":"variables_get_keypad","id":"~afpS]ef6Ym0_tlyxsLr","fields":{"VAR":{"id":"*5#BC_CDLI:7,Tq%_{#f","name":"inventor hub","type":"InventorHub"}}}},"VALUE0":{"shadow":{"type":"blockParametersButton","id":"9]%9@7g)h-`Fc$:7iu9/","fields":{"VALUE":"CENTER"}}}}}}}}}}}}}}},"next":{"block":{"type":"blockIfElse","id":"a)5x^boxETa_*q|*YQiH","extraState":{"optionLevel":0},"inputs":{"IF0":{"shadow":{"type":"blockLogicTrue","id":"zI0~8[`K2E?PqjnS*1o8"},"block":{"type":"blockButtonIsPressed","id":"*bS,Y|Z8u8iZ_L5{8%Er","inputs":{"VAR":{"shadow":{"type":"variables_get_keypad","id":"3QAoyHpvm`(h@m/9M=^G","fields":{"VAR":{"id":"*5#BC_CDLI:7,Tq%_{#f","name":"inventor hub","type":"InventorHub"}}}},"VALUE0":{"shadow":{"type":"blockParametersButton","id":"iBR]IdmERJ~L-7y!^#PD","fields":{"VALUE":"RIGHT"}}}}}},"DO0":{"block":{"type":"blockImportTaskCallStatement","id":"^eJyE#9Yau{IC{4A[:w:","extraState":{"optionLevel":2},"inputs":{"VAR":{"shadow":{"type":"variables_get_imported_function","id":"4I.j8T`-:qfPbNb#dfJg","fields":{"VAR":{"id":"H)(CPxdW.NkK~=wz;ku{","name":"set_light","type":"FunctionImported"}}}},"ARG0":{"shadow":{"type":"blockMathNumber","id":"e|87I,cMCG3/a?#7g|qT","fields":{"NUM":0}},"block":{"type":"blockVariableGetValue","id":"x3jNON?B_5k-/gCN;nk3","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"_1mA3N|R]UPxUK,qBM^k","fields":{"VAR":{"id":"7)~un:z)5e}=.]Wk?bCp","name":"train1","type":"Any"}}}}}}},"ARG1":{"shadow":{"type":"blockMathNumber","id":"aIFI?l$7u.sN.y!Y;cBp","fields":{"NUM":2}},"block":{"type":"variables_get_color","id":"$AtxJR~}/KQmxu!HyXv#","fields":{"COLOUR":"#ff0000","VAR":{"id":"omF5^C?F|_S2U^]Da5WM"}}}}}}}},"next":{"block":{"type":"blockComment","id":"t2js4j=9FCPmrva{!v?:","fields":{"FIELDNAME":"look for the color code\nIf you don't recognize it, reset to the old one\nIf it's the same as the old one don't do anything\nIf it's new then process it and update the old one"},"next":{"block":{"type":"blockVariableSetValue","id":";pi35(;,}rB(sLri3xn;","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"#6Z,K[dgA9Vxi2uds)v`","fields":{"VAR":{"id":"xrrSdt#dhf(z@N_OqNbl","name":"current color code","type":"Any"}}}},"VALUE0":{"shadow":{"type":"blockMathNumber","id":"$[gUz6%K{Gv0pZR;1rxb","fields":{"NUM":0}},"block":{"type":"blockImportTaskCallValue","id":"1020vg@]W$Ru]O}egW{D","extraState":{"optionLevel":2},"inputs":{"VAR":{"shadow":{"type":"variables_get_imported_function","id":"Ol+)Z=?wyjBh/4ERLAL?","fields":{"VAR":{"id":"LB$!O#z=:D;Ve=[[[MyW","name":"get_color","type":"FunctionImported"}}}},"ARG0":{"shadow":{"type":"blockMathNumber","id":"4N4CL-=%!sRxTt)3!S!d","fields":{"NUM":0}},"block":{"type":"blockVariableGetValue","id":",pIoe.2f0?.p1F_aSy:(","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"`m4ZL+D)|`|G`};GzJHT","fields":{"VAR":{"id":"7)~un:z)5e}=.]Wk?bCp","name":"train1","type":"Any"}}}}}}},"ARG1":{"shadow":{"type":"blockMathNumber","id":"DbIWsU*BIWOPo6_fSQaB","fields":{"NUM":0}},"block":{"type":"blockLogicTrueFalse","id":"IP|9zG%2NjyY_goo}KMR","fields":{"BOOL":"TRUE"}}}}}}},"next":{"block":{"type":"blockIfElse","id":"I@;3g5m(-(}^KUOI2!Cq","extraState":{"optionLevel":2},"inputs":{"IF0":{"shadow":{"type":"blockLogicTrue","id":"zI0~8[`K2E?PqjnS*1o8"},"block":{"type":"blockLogicCompare","id":"v:ug}X@F=jxe+8SkWb|~","fields":{"OP1":"EQ"},"inputs":{"A":{"shadow":{"type":"blockMathNumber","id":"]*PPh/r9`~~q3N;a|!`R","fields":{"NUM":3}},"block":{"type":"blockVariableGetValue","id":"hnjJc;f@gYgzy%%^0Z(#","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"]1~x_y7h~|)a11N0Xi:g","fields":{"VAR":{"id":"xrrSdt#dhf(z@N_OqNbl","name":"current color code","type":"Any"}}}}}}},"B":{"shadow":{"type":"blockMathNumber","id":"$V3}G[O02vmu?#KZ`mWY","fields":{"NUM":4}},"block":{"type":"blockNone","id":"i4yy|*Y1U7)[WT5zV(Gi"}}}}},"DO0":{"block":{"type":"blockVariableSetValue","id":"wA~4Lr/zaU#LjOTXeAw8","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"RST1GdqRZ`cqV~~j[2QG","fields":{"VAR":{"id":"xrrSdt#dhf(z@N_OqNbl","name":"current color code","type":"Any"}}}},"VALUE0":{"shadow":{"type":"blockMathNumber","id":"/JAYKeF3K;u/uWU/(^N_","fields":{"NUM":0}},"block":{"type":"blockVariableGetValue","id":"yI.%I};QQVDU4)zH5)Sd","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"A_.miY}9TA_`59oA6B`#","fields":{"VAR":{"id":"Et2W!b}zsYFYxI[Se.}N","name":"last color code","type":"Any"}}}}}}}}}},"IF1":{"shadow":{"type":"blockLogicTrue","id":"V!lG[Dy;J=!lwxEBWa8h"},"block":{"type":"blockLogicCompare","id":"`SJG9{P]eO(5bL{B,5{Y","fields":{"OP1":"NEQ"},"inputs":{"A":{"shadow":{"type":"blockMathNumber","id":"]*PPh/r9`~~q3N;a|!`R","fields":{"NUM":3}},"block":{"type":"blockVariableGetValue","id":"HZeNMB#gnp[Cj],l9N/9","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"{utF[z+m==)wk^LuO`iX","fields":{"VAR":{"id":"xrrSdt#dhf(z@N_OqNbl","name":"current color code","type":"Any"}}}}}}},"B":{"shadow":{"type":"blockMathNumber","id":"$BOr1:A$mq(lGx,uU)T]","fields":{"NUM":4}},"block":{"type":"blockVariableGetValue","id":"hDz@b4i;M]W=p|=Pfp..","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"WoD3SxPALE5)jRDQbFJ=","fields":{"VAR":{"id":"Et2W!b}zsYFYxI[Se.}N","name":"last color code","type":"Any"}}}}}}}}}},"DO1":{"block":{"type":"blockIfElse","id":"RpFx1r^:W6J9*63;I(|.","extraState":{"optionLevel":0},"inputs":{"IF0":{"shadow":{"type":"blockLogicTrue","id":"ME9yYxb66OYg]yJJiyxk"},"block":{"type":"blockLogicCompare","id":"snE.UO#(4#P7(v,PHvC{","fields":{"OP1":"EQ"},"inputs":{"A":{"shadow":{"type":"blockMathNumber","id":"]*PPh/r9`~~q3N;a|!`R","fields":{"NUM":3}},"block":{"type":"blockVariableGetValue","id":"Eb*oJWS/AcGtMkgF{Gyk","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":".KD%UT=C!3xU2GDke?7%","fields":{"VAR":{"id":"xrrSdt#dhf(z@N_OqNbl","name":"current color code","type":"Any"}}}}}}},"B":{"shadow":{"type":"blockMathNumber","id":"M)=crAown4X*UQ(Hv;^)","fields":{"NUM":4}},"block":{"type":"blockTextLiteral","id":"z)|*d,kT{-bB3?SyDF?)","fields":{"TEXT":"brightred"}}}}}},"DO0":{"block":{"type":"blockImportTaskCallStatement","id":"7T(f601o|T(VrI`z#?]l","extraState":{"optionLevel":2},"inputs":{"VAR":{"shadow":{"type":"variables_get_imported_function","id":"Z*~sP;^e8=7Q-Eq!Ww/S","fields":{"VAR":{"id":"NdzekE#*A-3^u{=XF,9y","name":"start_driving","type":"FunctionImported"}}}},"ARG0":{"shadow":{"type":"blockMathNumber","id":"]5lS8{~;tRFE{simAu2c","fields":{"NUM":0}},"block":{"type":"blockVariableGetValue","id":"+o]vASY{|!p3.:9|8H#g","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"?0]Ar!*O[pWd4bL0eYuf","fields":{"VAR":{"id":"7)~un:z)5e}=.]Wk?bCp","name":"train1","type":"Any"}}}}}}},"ARG1":{"shadow":{"type":"blockMathNumber","id":"`BBF3}YHJAf[ME7lknWP","fields":{"NUM":0}}}},"next":{"block":{"type":"blockMotorResetAngle","id":"*iAp],sI7j(m8/1?^p*T","inputs":{"VAR":{"shadow":{"type":"variables_get_motor_device","id":"/QgJPIcy:TfO}s/FgMei","fields":{"VAR":{"id":"A%Q4I{Fw1}[HZ25D/7sC","name":"dial","type":"Motor"}}}},"VALUE0":{"shadow":{"type":"unit_angle","id":"3ogtI9NG3Ftd^R/5rvnm","fields":{"VALUE0":0}}}}}}}}},"next":{"block":{"type":"blockVariableSetValue","id":")/wG-.t@hQN$Se.i#odx","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"=~i[7RB|Py]|l]{x.:d)","fields":{"VAR":{"id":"Et2W!b}zsYFYxI[Se.}N","name":"last color code","type":"Any"}}}},"VALUE0":{"shadow":{"type":"blockMathNumber","id":"/JAYKeF3K;u/uWU/(^N_","fields":{"NUM":0}},"block":{"type":"blockVariableGetValue","id":"h`L|/[FKO|8)e@AO{fdI","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"T:ap8^i:{_c4=*j,B*`I","fields":{"VAR":{"id":"xrrSdt#dhf(z@N_OqNbl","name":"current color code","type":"Any"}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},{"type":"blockComment","id":"n!`Udyoz]2%#^hTAX-K-","x":763,"y":1020,"enabled":false,"fields":{"FIELDNAME":"Detect colored bricks. Use it to update the duplo light and sound."},"next":{"block":{"type":"blockVariableSetValue","id":"TDq$l0#nYC{LR7Hn}@~W","enabled":false,"inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"DE6ob,07kFDsf.du_*)D","fields":{"VAR":{"id":"zU|zw|^jx16lQDrMxQ!}","name":"current color","type":"Any"}}}},"VALUE0":{"shadow":{"type":"blockMathNumber","id":"/JAYKeF3K;u/uWU/(^N_","fields":{"NUM":0}},"block":{"type":"blockColor","id":"dc5KtZ,_uV9!(fEJP3@S","extraState":{"optionLevel":0},"fields":{"METHOD":"COLOR_GET_COLOR"},"inputs":{"VAR":{"shadow":{"type":"variables_get_color_device","id":"WT_-@hBcr.iId(ZLUi[Q","fields":{"VAR":{"id":"@XZHI/7H?CTN~buGAy24","name":"color sensor","type":"ColorSensor"}}}}}}}},"next":{"block":{"type":"blockComment","id":"|H8@,Iq[Z4sXFx1]k{*_","enabled":false,"fields":{"FIELDNAME":"Do something only if the color changed."},"next":{"block":{"type":"blockIfElse","id":"h.?N2ae6~U%bck*W_emH","enabled":false,"extraState":{"optionLevel":0},"inputs":{"IF0":{"shadow":{"type":"blockLogicTrue","id":"#CNcrihgWB]?HVAv08rX"},"block":{"type":"blockLogicCompare","id":"Im;@Q2.^G2p;E-mvx52t","fields":{"OP1":"NEQ"},"inputs":{"A":{"shadow":{"type":"blockMathNumber","id":"]*PPh/r9`~~q3N;a|!`R","fields":{"NUM":3}},"block":{"type":"blockVariableGetValue","id":"fUkZrF_jsh(J#x:,oG0t","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"F:6;7``lT?_-BZ2*rAY_","fields":{"VAR":{"id":"zU|zw|^jx16lQDrMxQ!}","name":"current color","type":"Any"}}}}}}},"B":{"shadow":{"type":"blockMathNumber","id":"(lru~,aC$~nkNf/7zJmP","fields":{"NUM":4}},"block":{"type":"blockVariableGetValue","id":"%u[;7v`8U2m}z]is$A5f","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"y?ovpSE,Ek)WbEf7]9ri","fields":{"VAR":{"id":"TE4wo///`0hS0R{cxKph","name":"last color","type":"Any"}}}}}}}}}},"DO0":{"block":{"type":"blockComment","id":",#,at`j+``_3-Acgg,}4","fields":{"FIELDNAME":"If there is any color (not none), sound the horn."},"next":{"block":{"type":"blockIfElse","id":"*+}(zy,[gPtUx*Tgf{a7","extraState":{"optionLevel":0},"inputs":{"IF0":{"shadow":{"type":"blockLogicTrue","id":"wLvbOxGLR{-:+L~5d64("},"block":{"type":"blockLogicCompare","id":"ykJziB!.cC@X^IT;-GIl","fields":{"OP1":"NEQ"},"inputs":{"A":{"shadow":{"type":"blockMathNumber","id":"]*PPh/r9`~~q3N;a|!`R","fields":{"NUM":3}},"block":{"type":"blockVariableGetValue","id":"_P$B4@NbR@,YFb[KCzl=","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"**O/+2fo3kuy0LMcSyB@","fields":{"VAR":{"id":"zU|zw|^jx16lQDrMxQ!}","name":"current color","type":"Any"}}}}}}},"B":{"shadow":{"type":"blockMathNumber","id":".e/9=f$%P`xXnUG-wy{[","fields":{"NUM":4}},"block":{"type":"variables_get_color","id":"oF^Lw7cgfwdi#_2L3/EK","fields":{"COLOUR":"#000000","VAR":{"id":"TFmFW?).wKf=+rwisHES"}}}}}}},"DO0":{"block":{"type":"blockImportTaskCallStatement","id":"D2]uxAl$PBl$0#BB/%h{","extraState":{"optionLevel":2},"inputs":{"VAR":{"shadow":{"type":"variables_get_imported_function","id":"5iKLMDjjHb6`5mvvI-pr","fields":{"VAR":{"id":"H)(CPxdW.NkK~=wz;ku{","name":"set_light","type":"FunctionImported"}}}},"ARG0":{"shadow":{"type":"blockMathNumber","id":"e|87I,cMCG3/a?#7g|qT","fields":{"NUM":0}},"block":{"type":"blockVariableGetValue","id":"CHkASeF75QP{VIgw0ZxJ","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"X?`xLvGav%Z+iS%S|OMf","fields":{"VAR":{"id":"7)~un:z)5e}=.]Wk?bCp","name":"train1","type":"Any"}}}}}}},"ARG1":{"shadow":{"type":"blockMathNumber","id":"f$4d-]=hNJZ9XhAm?bHN","fields":{"NUM":0}},"block":{"type":"blockVariableGetValue","id":"3[cN/}[ciylUU!88}:$e","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"97iC_z)3m-Wd=.qa;[DD","fields":{"VAR":{"id":"zU|zw|^jx16lQDrMxQ!}","name":"current color","type":"Any"}}}}}}}}}}},"next":{"block":{"type":"blockComment","id":"dm`WG!80OhNXF:u5!TFK","fields":{"FIELDNAME":"Update the hub and train light to match the brick color."},"next":{"block":{"type":"blockLightOnColor","id":"T*$sZN+bri?yD$om#Qyd","extraState":{"optionLevel":1},"fields":{"METHOD":"LIGHT_ON"},"inputs":{"VAR":{"shadow":{"type":"variables_get_color_light_device","id":"oIc12/y?-Ce;N{gEAUZa","fields":{"VAR":{"id":"*5#BC_CDLI:7,Tq%_{#f","name":"inventor hub","type":"InventorHub"}}}},"COLOR":{"shadow":{"type":"variables_get_color","id":"v+wSjov.Sdr9:_Skf/:(","fields":{"COLOUR":"#ff0000","VAR":{"id":"omF5^C?F|_S2U^]Da5WM","name":"red","type":"ColorDef"}}},"block":{"type":"blockVariableGetValue","id":"A~R(@uf{0w$Vz`feVyg#","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"y6-/O4((u2NQo{.T5uQh","fields":{"VAR":{"id":"zU|zw|^jx16lQDrMxQ!}","name":"current color","type":"Any"}}}}}}}},"next":{"block":{"type":"blockImportTaskCallStatement","id":"[y/$X*mA@e{8[TCgMZq5","extraState":{"optionLevel":2},"inputs":{"VAR":{"shadow":{"type":"variables_get_imported_function","id":"Ydl);J;Q0vF7h1I/7+kd","fields":{"VAR":{"id":"H)(CPxdW.NkK~=wz;ku{","name":"set_light","type":"FunctionImported"}}}},"ARG0":{"shadow":{"type":"blockMathNumber","id":"e|87I,cMCG3/a?#7g|qT","fields":{"NUM":0}},"block":{"type":"blockVariableGetValue","id":"C3-d*/h;X#^/3p[sF6lz","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"E*Gqx3.c|5mdS}VMz*{)","fields":{"VAR":{"id":"7)~un:z)5e}=.]Wk?bCp","name":"train1","type":"Any"}}}}}}},"ARG1":{"shadow":{"type":"blockMathNumber","id":"f$4d-]=hNJZ9XhAm?bHN","fields":{"NUM":0}},"block":{"type":"blockVariableGetValue","id":"D$6^rfF27b(bHNHj3Nmk","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"FgNhUf~Z*2EjfB2!Zn%a","fields":{"VAR":{"id":"zU|zw|^jx16lQDrMxQ!}","name":"current color","type":"Any"}}}}}}}},"next":{"block":{"type":"blockVariableSetValue","id":"=nQ:3DtV!BN0nxtFl?PV","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"DW`wY+v=k!@d[)@8%I32","fields":{"VAR":{"id":"TE4wo///`0hS0R{cxKph","name":"last color","type":"Any"}}}},"VALUE0":{"shadow":{"type":"blockMathNumber","id":"/JAYKeF3K;u/uWU/(^N_","fields":{"NUM":0}},"block":{"type":"blockVariableGetValue","id":"aXZUDt$ho^iQ)(%/nHJ=","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"=q|s2gp7Bf?Pb+qtN$5z","fields":{"VAR":{"id":"zU|zw|^jx16lQDrMxQ!}","name":"current color","type":"Any"}}}}}}}}}}}}}}}}}}}}}}}}}}}},{"type":"blockTextLiteral","id":"$+}Y#*T:W[`-wD$D{j7K","x":572,"y":1271,"enabled":false,"fields":{"TEXT":"white"}}]},"variables":[{"name":"red","id":"omF5^C?F|_S2U^]Da5WM","type":"ColorDef"},{"name":"orange","id":"c4B}9l^;G*zq3ivTVEeO","type":"ColorDef"},{"name":"yellow","id":"X{5Y-Em{$l`HC{[4_/*Q","type":"ColorDef"},{"name":"green","id":"]dSoqm%[m9g2|lcZ?Vt%","type":"ColorDef"},{"name":"cyan","id":"g3Twx:Qh[n8zecY^e,:}","type":"ColorDef"},{"name":"blue","id":"m(z^qpO7D5BW9tz26|Pf","type":"ColorDef"},{"name":"violet","id":"Y{?!s3Ht.4,JX]Pn4{3d","type":"ColorDef"},{"name":"magenta","id":"P#0lFve(w}KW!j_+.q{w","type":"ColorDef"},{"name":"white","id":"a%.-R]L(`w^(o=AEt]K`","type":"ColorDef"},{"name":"none","id":"TFmFW?).wKf=+rwisHES","type":"ColorDef"},{"name":"color sensor","id":"@XZHI/7H?CTN~buGAy24","type":"ColorSensor"},{"name":"duplo","id":"675Tewb-hZRNskTpaPR^","type":"ModuleImported"},{"name":"dial","id":"A%Q4I{Fw1}[HZ25D/7sC","type":"Motor"},{"name":"start_driving","id":"NdzekE#*A-3^u{=XF,9y","type":"FunctionImported"},{"name":"play_sound","id":"InaCEX!Wvubx{)h9ua7L","type":"FunctionImported"},{"name":"DuploTrain","id":"Sffa}}200*Q_|`ua!5IE","type":"FunctionImported"},{"name":"set_light","id":"H)(CPxdW.NkK~=wz;ku{","type":"FunctionImported"},{"name":"get_color","id":"LB$!O#z=:D;Ve=[[[MyW","type":"FunctionImported"},{"name":"last color","id":"TE4wo///`0hS0R{cxKph","type":"Any"},{"name":"current color","id":"zU|zw|^jx16lQDrMxQ!}","type":"Any"},{"name":"train1","id":"7)~un:z)5e}=.]Wk?bCp","type":"Any"},{"name":"last color code","id":"Et2W!b}zsYFYxI[Se.}N","type":"Any"},{"name":"current color code","id":"xrrSdt#dhf(z@N_OqNbl","type":"Any"},{"name":"inventor hub","id":"*5#BC_CDLI:7,Tq%_{#f","type":"InventorHub"}],"info":{"type":"pybricks","version":"1.3.2"}}
from pybricks.hubs import InventorHub
from pybricks.parameters import Button, Color, Direction, Port
from pybricks.pupdevices import ColorSensor, Motor
from pybricks.tools import wait

from duplo import DuploTrain, get_color, play_sound, set_light, start_driving

# Set up all devices.
inventor_hub = InventorHub()
color_sensor = ColorSensor(Port.F)
dial = Motor(Port.A, Direction.CLOCKWISE)

# Initialize variables.
train1 = DuploTrain()
last_color = Color.NONE
current_color = Color.NONE
last_color_code = None
current_color_code = None


# The main program starts here.
dial.reset_angle(0)
# My youngest would often press the hub button. This
# normally stops the program, so it interrupts the fun
# of just playing and independently exploring.

# This block disables that, so the program doesn't stop.
# If you do want to stop eventually, just hold the button
# to turn the hub off entirely, as you normally would.
inventor_hub.system.set_stop_button(Button.BLUETOOTH)
while True:
    # Set the train speed based on the motor angle.
    start_driving(train1, dial.angle())
    # Play a sound if the hub button is pressed.
    if Button.CENTER in inventor_hub.buttons.pressed():
        play_sound(train1, 'depart')
        while Button.CENTER in inventor_hub.buttons.pressed():
            wait(0)
    if Button.RIGHT in inventor_hub.buttons.pressed():
        set_light(train1, Color.RED)
    # look for the color code
    # If you don't recognize it, reset to the old one
    # If it's the same as the old one don't do anything
    # If it's new then process it and update the old one
    current_color_code = get_color(train1, True)
    if current_color_code == None:
        current_color_code = last_color_code
    elif current_color_code != last_color_code:
        if current_color_code == 'brightred':
            start_driving(train1, 0)
            dial.reset_angle(0)
        last_color_code = current_color_code
    else:
        pass
