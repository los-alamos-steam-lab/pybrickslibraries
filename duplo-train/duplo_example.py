# pybricks blocks file:{"blocks":{"languageVersion":0,"blocks":[{"type":"blockGlobalSetup","id":"bjK,wS1MYO7aiYkFSwd{","x":16,"y":-8,"deletable":false,"next":{"block":{"type":"variables_set_inventor_hub","id":"{PfnO/^^7jbE|:YQqv0_","extraState":{"optionLevel":0},"fields":{"VAR":{"id":"*5#BC_CDLI:7,Tq%_{#f"}},"next":{"block":{"type":"variables_setup_imported_function","id":"giC/s|xX/K+.WCijR:zo","fields":{"FROM_MODULE":{"id":"%]2OUS2}u#;!=@-Ac*wK"},"VAR":{"id":"Sffa}}200*Q_|`ua!5IE"}},"next":{"block":{"type":"variables_setup_imported_function","id":"=}XV0~`:H4uDYYfl-:pP","fields":{"FROM_MODULE":{"id":"%]2OUS2}u#;!=@-Ac*wK"},"VAR":{"id":"NdzekE#*A-3^u{=XF,9y"}},"next":{"block":{"type":"variables_setup_imported_function","id":"$N9wYz5Ei.nBnb!s-E4`","fields":{"FROM_MODULE":{"id":"%]2OUS2}u#;!=@-Ac*wK"},"VAR":{"id":"InaCEX!Wvubx{)h9ua7L"}},"next":{"block":{"type":"variables_setup_imported_function","id":"9de-bU,Q93MJsx-Ws-@H","fields":{"FROM_MODULE":{"id":"%]2OUS2}u#;!=@-Ac*wK"},"VAR":{"id":"H)(CPxdW.NkK~=wz;ku{"}},"next":{"block":{"type":"variables_setup_imported_function","id":"OmOGV]+h9YF6;e({M0qo","fields":{"FROM_MODULE":{"id":"%]2OUS2}u#;!=@-Ac*wK"},"VAR":{"id":"LB$!O#z=:D;Ve=[[[MyW"}},"next":{"block":{"type":"variables_setup_imported_function","id":"R@9(nhDk)iIaiui#Aba=","fields":{"FROM_MODULE":{"id":"%]2OUS2}u#;!=@-Ac*wK"},"VAR":{"id":"w6|U{/Fa)FphL]lf]hAb"}},"next":{"block":{"type":"variables_setup_any","id":".i]KE~yO`yx2nb$dJ^UD","fields":{"VAR":{"id":"7)~un:z)5e}=.]Wk?bCp"}},"inputs":{"VALUE0":{"shadow":{"type":"blockMathNumber","id":"kRDg[]2Jjl/I7$iGo{u;","fields":{"NUM":0}},"block":{"type":"blockImportTaskCallValue","id":"WbkBvd[VGI-zG7LbS$ub","extraState":{"optionLevel":0},"inputs":{"VAR":{"shadow":{"type":"variables_get_imported_function","id":"g,noa/6jb8V.:Da5`;2c","fields":{"VAR":{"id":"Sffa}}200*Q_|`ua!5IE","name":"DuploTrain","type":"FunctionImported"}}}}}}}},"next":{"block":{"type":"variables_set_motor","id":"fEi2x[#OqUMq5sguv5Z@","fields":{"VAR":{"id":"A%Q4I{Fw1}[HZ25D/7sC"}},"inputs":{"PORT":{"shadow":{"type":"blockParametersPort","id":"kEO(A/bs@Lb*g_AUK5=V","fields":{"NAME":"A"}}},"POSITIVE_DIRECTION":{"shadow":{"type":"blockParametersDirection","id":"kTOtk9n{hKY+nkHvu?-9","fields":{"SELECTION":"Direction.CLOCKWISE"}}}},"next":{"block":{"type":"variables_setup_any","id":"s(2!s`*s.vB}q(#uP:B|","fields":{"VAR":{"id":"Et2W!b}zsYFYxI[Se.}N"}},"inputs":{"VALUE0":{"shadow":{"type":"blockMathNumber","id":"I+S}o*$ZhlvqWR:gq03}","fields":{"NUM":0}},"block":{"type":"blockNone","id":",)H[7Yz6X_52}VKro6E/"}}},"next":{"block":{"type":"variables_setup_any","id":"oS)j(_[}~Tz@3#D`D=hn","fields":{"VAR":{"id":"xrrSdt#dhf(z@N_OqNbl"}},"inputs":{"VALUE0":{"shadow":{"type":"blockMathNumber","id":"?NZIDE2g=m)]|SKumV(?","fields":{"NUM":0}},"block":{"type":"blockNone","id":"$8-wZ5i#fLB(e=H-oRZ;"}}}}}}}}}}}}}}}}}}}}}}}}}},{"type":"blockGlobalStart","id":"3tJe|AWl0baN(wH9a$@.","x":0,"y":799,"deletable":false,"next":{"block":{"type":"blockMotorResetAngle","id":"X005$lM;]ER|){rxF@Hb","inputs":{"VAR":{"shadow":{"type":"variables_get_motor_device","id":"=UI5iQJ$4FQQL;=e`M2=","fields":{"VAR":{"id":"A%Q4I{Fw1}[HZ25D/7sC","name":"dial","type":"Motor"}}}},"VALUE0":{"shadow":{"type":"unit_angle","id":"TR?=F+tC]E1wvLmcvxMT","fields":{"VALUE0":0}}}},"next":{"block":{"type":"blockHubStopButton","id":"hcI!/Ho0c.Dcq=lU`rrq","inputs":{"VAR":{"shadow":{"type":"variables_get_button_hub","id":"H.D:DDKpPt1URrl`G/wf","fields":{"VAR":{"id":"*5#BC_CDLI:7,Tq%_{#f","name":"inventor hub","type":"InventorHub"}}}},"VALUE0":{"shadow":{"type":"blockParametersButton","id":",~Vh82WirQz;@W9Sn.BF","fields":{"VALUE":"BLUETOOTH"}}}},"next":{"block":{"type":"blockFlowWhile","id":"kNA3Ql:gd,YZ~o`U3HFf","fields":{"MODE":"WHILE"},"inputs":{"BOOL":{"shadow":{"type":"blockLogicTrue","id":"~PrquIN`#DE76x;sQT,-"}},"DO":{"block":{"type":"blockComment","id":"_B]B5L(Tv|hS7!yHK^rb","fields":{"FIELDNAME":"Set the train speed based on the motor angle."},"next":{"block":{"type":"blockImportTaskCallStatement","id":"?d_^.Nlq_c]::q7V{KIz","extraState":{"optionLevel":2},"inputs":{"VAR":{"shadow":{"type":"variables_get_imported_function","id":"dVbN@gwIxP7;89X-.y,5","fields":{"VAR":{"id":"NdzekE#*A-3^u{=XF,9y","name":"start_driving","type":"FunctionImported"}}}},"ARG0":{"shadow":{"type":"blockMathNumber","id":"]5lS8{~;tRFE{simAu2c","fields":{"NUM":0}},"block":{"type":"blockVariableGetValue","id":"$Z9-RoAZ@-X)XvEHA8Yl","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"188iblNXCJ}oVeq=gsl@","fields":{"VAR":{"id":"7)~un:z)5e}=.]Wk?bCp","name":"train","type":"Any"}}}}}}},"ARG1":{"shadow":{"type":"blockMathNumber","id":"`BBF3}YHJAf[ME7lknWP","fields":{"NUM":0}},"block":{"type":"blockMotorMeasure","id":"v(MsO;0F/c%4Xx)Uz3`A","extraState":{"optionLevel":1},"fields":{"METHOD":"MOTOR_ANGLE"},"inputs":{"VAR":{"shadow":{"type":"variables_get_motor_device","id":"Y1SL3[?DJUfr.m#yv.!u","fields":{"VAR":{"id":"A%Q4I{Fw1}[HZ25D/7sC","name":"dial","type":"Motor"}}}}}}}},"next":{"block":{"type":"blockComment","id":"KW3S)7[n{X/r,=1LhFQI","fields":{"FIELDNAME":"Play a sound if the hub button is pressed."},"next":{"block":{"type":"blockIfElse","id":"v)^9}@2LrGx`b|I4dK~v","extraState":{"optionLevel":0},"inputs":{"IF0":{"shadow":{"type":"blockLogicTrue","id":"zI0~8[`K2E?PqjnS*1o8"},"block":{"type":"blockButtonIsPressed","id":"=Yr:J3Co*%D|AYy-:cZQ","inputs":{"VAR":{"shadow":{"type":"variables_get_keypad","id":"aXy%S3*+fY.oF#1j@ZUA","fields":{"VAR":{"id":"*5#BC_CDLI:7,Tq%_{#f","name":"inventor hub","type":"InventorHub"}}}},"VALUE0":{"shadow":{"type":"blockParametersButton","id":"[p#wDekt^|~_$x{/VV*h","fields":{"VALUE":"LEFT"}}}}}},"DO0":{"block":{"type":"blockImportTaskCallStatement","id":"n$-RekZ{=^Cr-,smU#8?","extraState":{"optionLevel":2},"inputs":{"VAR":{"shadow":{"type":"variables_get_imported_function","id":"{nG?[vNSEQ.AX+{A$%r%","fields":{"VAR":{"id":"InaCEX!Wvubx{)h9ua7L","name":"play_sound","type":"FunctionImported"}}}},"ARG0":{"shadow":{"type":"blockMathNumber","id":"k*kN}}Ni!gyWAr#OsKen","fields":{"NUM":50}},"block":{"type":"blockVariableGetValue","id":"{zaWnV+o$.e$z=AQB`rT","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"a|cXV.~[IiS?f[:JGmVA","fields":{"VAR":{"id":"7)~un:z)5e}=.]Wk?bCp","name":"train","type":"Any"}}}}}}},"ARG1":{"shadow":{"type":"blockMathNumber","id":"B%d#N@tor?Fdx;7!2uYP","fields":{"NUM":0}},"block":{"type":"blockTextLiteral","id":"])tK^}]`!$YeGCh-HG4;","fields":{"TEXT":"depart"}}}},"next":{"block":{"type":"blockWaitUntil","id":"%CH{0LJ5NU-#wL)rBnOE","inputs":{"BOOL":{"shadow":{"type":"blockLogicTrue","id":"f!B]ND?BM^EcCiOCs0k,"},"block":{"type":"blockLogicIsNone","id":"vs*d88oa_V-HhQI1-F;N","fields":{"OP":"NOT"},"inputs":{"BOOL":{"shadow":{"type":"blockLogicTrue","id":"O5)5@ZgrGO^u7^@:o[7O"},"block":{"type":"blockButtonIsPressed","id":"CMj05}Z/{EB*N|oKYD8$","inputs":{"VAR":{"shadow":{"type":"variables_get_keypad","id":"~afpS]ef6Ym0_tlyxsLr","fields":{"VAR":{"id":"*5#BC_CDLI:7,Tq%_{#f","name":"inventor hub","type":"InventorHub"}}}},"VALUE0":{"shadow":{"type":"blockParametersButton","id":"9]%9@7g)h-`Fc$:7iu9/","fields":{"VALUE":"CENTER"}}}}}}}}}}}}}}},"next":{"block":{"type":"blockIfElse","id":"!$Vk6u5BAT6;qVqM@OPa","extraState":{"optionLevel":0},"inputs":{"IF0":{"shadow":{"type":"blockLogicTrue","id":"zI0~8[`K2E?PqjnS*1o8"},"block":{"type":"blockButtonIsPressed","id":"[AdqvEm;vq]lto`K#)I0","inputs":{"VAR":{"shadow":{"type":"variables_get_keypad","id":"US!~MN6yjS6mB3MV=RAX","fields":{"VAR":{"id":"*5#BC_CDLI:7,Tq%_{#f","name":"inventor hub","type":"InventorHub"}}}},"VALUE0":{"shadow":{"type":"blockParametersButton","id":"jP}Hh228x=u#]1:YObxh","fields":{"VALUE":"RIGHT"}}}}}},"DO0":{"block":{"type":"blockImportTaskCallStatement","id":"2YFSGKSj@C2;,n|6oiAz","extraState":{"optionLevel":2},"inputs":{"VAR":{"shadow":{"type":"variables_get_imported_function","id":"~5pw~M.Psxs:_K:Tv:lI","fields":{"VAR":{"id":"H)(CPxdW.NkK~=wz;ku{","name":"set_light","type":"FunctionImported"}}}},"ARG0":{"shadow":{"type":"blockMathNumber","id":"k*kN}}Ni!gyWAr#OsKen","fields":{"NUM":50}},"block":{"type":"blockVariableGetValue","id":"liJ3m?/jxh{``1C$R$,5","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"TB5][}ZMk+vETSZ$HUc`","fields":{"VAR":{"id":"7)~un:z)5e}=.]Wk?bCp","name":"train","type":"Any"}}}}}}},"ARG1":{"shadow":{"type":"blockMathNumber","id":"B%d#N@tor?Fdx;7!2uYP","fields":{"NUM":0}},"block":{"type":"variables_get_color","id":"B$FZ0|cU9jzI:A,EkkeV","fields":{"COLOUR":"#ff0000","VAR":{"id":"omF5^C?F|_S2U^]Da5WM"}}}}}}}},"next":{"block":{"type":"blockFunctionCallerStatement","id":"FaWvi~/bW,E%*B(]kp|I","extraState":{"optionLevel":0},"fields":{"ICON":"TASK","VAR":{"id":"QI($xQ`cv$LJ^6wuP.0G"}}}}}}}}}}}}}}}}}}}}}},{"type":"blockImportTaskCallStatement","id":"*gk3=~T]~n1EmFv;+nth","x":267,"y":2368,"enabled":false,"extraState":{"optionLevel":1},"inputs":{"VAR":{"shadow":{"type":"variables_get_imported_function","id":"5J*tun9$`o8B{~NlS:Z^","fields":{"VAR":{"id":"w6|U{/Fa)FphL]lf]hAb","name":"read","type":"FunctionImported"}}}},"ARG0":{"shadow":{"type":"blockMathNumber","id":"e|87I,cMCG3/a?#7g|qT","fields":{"NUM":0}},"block":{"type":"blockVariableGetValue","id":".FOi}NDXGkx+YmZJ9ln;","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"b4$dgC#X5M#dp%0Se-dt","fields":{"VAR":{"id":"7)~un:z)5e}=.]Wk?bCp","name":"train","type":"Any"}}}}}}}}},{"type":"variables_setup_function","id":"rqwDmUdKD.2De5y61`HE","x":873,"y":892,"extraState":{"optionLevel":0},"fields":{"ICON":"TASK","VAR":{"id":"QI($xQ`cv$LJ^6wuP.0G"}},"inputs":{"STACK":{"block":{"type":"blockComment","id":"t2js4j=9FCPmrva{!v?:","fields":{"FIELDNAME":"look for the color code\nIf you don't recognize it, reset to the old one\nIf it's the same as the old one don't do anything\nIf it's new then process it and update the old one"},"next":{"block":{"type":"blockVariableSetValue","id":";pi35(;,}rB(sLri3xn;","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"#6Z,K[dgA9Vxi2uds)v`","fields":{"VAR":{"id":"xrrSdt#dhf(z@N_OqNbl","name":"current color code","type":"Any"}}}},"VALUE0":{"shadow":{"type":"blockMathNumber","id":"$[gUz6%K{Gv0pZR;1rxb","fields":{"NUM":0}},"block":{"type":"blockImportTaskCallValue","id":"1020vg@]W$Ru]O}egW{D","extraState":{"optionLevel":2},"inputs":{"VAR":{"shadow":{"type":"variables_get_imported_function","id":"Ol+)Z=?wyjBh/4ERLAL?","fields":{"VAR":{"id":"LB$!O#z=:D;Ve=[[[MyW","name":"get_color","type":"FunctionImported"}}}},"ARG0":{"shadow":{"type":"blockMathNumber","id":"4N4CL-=%!sRxTt)3!S!d","fields":{"NUM":0}},"block":{"type":"blockVariableGetValue","id":",pIoe.2f0?.p1F_aSy:(","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"`m4ZL+D)|`|G`};GzJHT","fields":{"VAR":{"id":"7)~un:z)5e}=.]Wk?bCp","name":"train","type":"Any"}}}}}}},"ARG1":{"shadow":{"type":"blockMathNumber","id":"DbIWsU*BIWOPo6_fSQaB","fields":{"NUM":0}},"block":{"type":"blockLogicTrueFalse","id":"IP|9zG%2NjyY_goo}KMR","fields":{"BOOL":"TRUE"}}}}}}},"next":{"block":{"type":"blockIfElse","id":"I@;3g5m(-(}^KUOI2!Cq","extraState":{"optionLevel":2},"inputs":{"IF0":{"shadow":{"type":"blockLogicTrue","id":"zI0~8[`K2E?PqjnS*1o8"},"block":{"type":"blockLogicCompare","id":"v:ug}X@F=jxe+8SkWb|~","fields":{"OP1":"EQ"},"inputs":{"A":{"shadow":{"type":"blockMathNumber","id":"]*PPh/r9`~~q3N;a|!`R","fields":{"NUM":3}},"block":{"type":"blockVariableGetValue","id":"hnjJc;f@gYgzy%%^0Z(#","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"]1~x_y7h~|)a11N0Xi:g","fields":{"VAR":{"id":"xrrSdt#dhf(z@N_OqNbl","name":"current color code","type":"Any"}}}}}}},"B":{"shadow":{"type":"blockMathNumber","id":"$V3}G[O02vmu?#KZ`mWY","fields":{"NUM":4}},"block":{"type":"blockNone","id":"i4yy|*Y1U7)[WT5zV(Gi"}}}}},"DO0":{"block":{"type":"blockVariableSetValue","id":"wA~4Lr/zaU#LjOTXeAw8","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"RST1GdqRZ`cqV~~j[2QG","fields":{"VAR":{"id":"xrrSdt#dhf(z@N_OqNbl","name":"current color code","type":"Any"}}}},"VALUE0":{"shadow":{"type":"blockMathNumber","id":"/JAYKeF3K;u/uWU/(^N_","fields":{"NUM":0}},"block":{"type":"blockVariableGetValue","id":"yI.%I};QQVDU4)zH5)Sd","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"A_.miY}9TA_`59oA6B`#","fields":{"VAR":{"id":"Et2W!b}zsYFYxI[Se.}N","name":"last color code","type":"Any"}}}}}}}}}},"IF1":{"shadow":{"type":"blockLogicTrue","id":"V!lG[Dy;J=!lwxEBWa8h"},"block":{"type":"blockLogicCompare","id":"`SJG9{P]eO(5bL{B,5{Y","fields":{"OP1":"NEQ"},"inputs":{"A":{"shadow":{"type":"blockMathNumber","id":"]*PPh/r9`~~q3N;a|!`R","fields":{"NUM":3}},"block":{"type":"blockVariableGetValue","id":"HZeNMB#gnp[Cj],l9N/9","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"{utF[z+m==)wk^LuO`iX","fields":{"VAR":{"id":"xrrSdt#dhf(z@N_OqNbl","name":"current color code","type":"Any"}}}}}}},"B":{"shadow":{"type":"blockMathNumber","id":"$BOr1:A$mq(lGx,uU)T]","fields":{"NUM":4}},"block":{"type":"blockVariableGetValue","id":"hDz@b4i;M]W=p|=Pfp..","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"WoD3SxPALE5)jRDQbFJ=","fields":{"VAR":{"id":"Et2W!b}zsYFYxI[Se.}N","name":"last color code","type":"Any"}}}}}}}}}},"DO1":{"block":{"type":"blockIfElse","id":"RpFx1r^:W6J9*63;I(|.","extraState":{"optionLevel":0},"inputs":{"IF0":{"shadow":{"type":"blockLogicTrue","id":"ME9yYxb66OYg]yJJiyxk"},"block":{"type":"blockLogicCompare","id":"snE.UO#(4#P7(v,PHvC{","fields":{"OP1":"EQ"},"inputs":{"A":{"shadow":{"type":"blockMathNumber","id":"]*PPh/r9`~~q3N;a|!`R","fields":{"NUM":3}},"block":{"type":"blockVariableGetValue","id":"Eb*oJWS/AcGtMkgF{Gyk","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":".KD%UT=C!3xU2GDke?7%","fields":{"VAR":{"id":"xrrSdt#dhf(z@N_OqNbl","name":"current color code","type":"Any"}}}}}}},"B":{"shadow":{"type":"blockMathNumber","id":"M)=crAown4X*UQ(Hv;^)","fields":{"NUM":4}},"block":{"type":"blockTextLiteral","id":"z)|*d,kT{-bB3?SyDF?)","fields":{"TEXT":"brightred"}}}}}},"DO0":{"block":{"type":"blockImportTaskCallStatement","id":"7T(f601o|T(VrI`z#?]l","extraState":{"optionLevel":2},"inputs":{"VAR":{"shadow":{"type":"variables_get_imported_function","id":"Z*~sP;^e8=7Q-Eq!Ww/S","fields":{"VAR":{"id":"NdzekE#*A-3^u{=XF,9y","name":"start_driving","type":"FunctionImported"}}}},"ARG0":{"shadow":{"type":"blockMathNumber","id":"]5lS8{~;tRFE{simAu2c","fields":{"NUM":0}},"block":{"type":"blockVariableGetValue","id":"+o]vASY{|!p3.:9|8H#g","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"?0]Ar!*O[pWd4bL0eYuf","fields":{"VAR":{"id":"7)~un:z)5e}=.]Wk?bCp","name":"train","type":"Any"}}}}}}},"ARG1":{"shadow":{"type":"blockMathNumber","id":"`BBF3}YHJAf[ME7lknWP","fields":{"NUM":0}}}},"next":{"block":{"type":"blockMotorResetAngle","id":"*iAp],sI7j(m8/1?^p*T","inputs":{"VAR":{"shadow":{"type":"variables_get_motor_device","id":"/QgJPIcy:TfO}s/FgMei","fields":{"VAR":{"id":"A%Q4I{Fw1}[HZ25D/7sC","name":"dial","type":"Motor"}}}},"VALUE0":{"shadow":{"type":"unit_angle","id":"3ogtI9NG3Ftd^R/5rvnm","fields":{"VALUE0":0}}}}}}}}},"next":{"block":{"type":"blockVariableSetValue","id":")/wG-.t@hQN$Se.i#odx","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"=~i[7RB|Py]|l]{x.:d)","fields":{"VAR":{"id":"Et2W!b}zsYFYxI[Se.}N","name":"last color code","type":"Any"}}}},"VALUE0":{"shadow":{"type":"blockMathNumber","id":"/JAYKeF3K;u/uWU/(^N_","fields":{"NUM":0}},"block":{"type":"blockVariableGetValue","id":"h`L|/[FKO|8)e@AO{fdI","inputs":{"VAR":{"shadow":{"type":"variables_get_any","id":"T:ap8^i:{_c4=*j,B*`I","fields":{"VAR":{"id":"xrrSdt#dhf(z@N_OqNbl","name":"current color code","type":"Any"}}}}}}}}}}}}}}}}}}}}},{"type":"variables_setup_any","id":"xZ=xm5c$ni1qJiu))M;R","x":1165,"y":640,"enabled":false,"fields":{"VAR":{"id":"TE4wo///`0hS0R{cxKph"}},"inputs":{"VALUE0":{"shadow":{"type":"blockMathNumber","id":"/9!vjomG]9jBNf*^R9yi","fields":{"NUM":0}},"block":{"type":"variables_get_color","id":"bhS6p](@/d$]^Nq+/@{i","fields":{"COLOUR":"#000000","VAR":{"id":"TFmFW?).wKf=+rwisHES"}}}}}}]},"variables":[{"name":"red","id":"omF5^C?F|_S2U^]Da5WM","type":"ColorDef"},{"name":"orange","id":"c4B}9l^;G*zq3ivTVEeO","type":"ColorDef"},{"name":"yellow","id":"X{5Y-Em{$l`HC{[4_/*Q","type":"ColorDef"},{"name":"green","id":"]dSoqm%[m9g2|lcZ?Vt%","type":"ColorDef"},{"name":"cyan","id":"g3Twx:Qh[n8zecY^e,:}","type":"ColorDef"},{"name":"blue","id":"m(z^qpO7D5BW9tz26|Pf","type":"ColorDef"},{"name":"violet","id":"Y{?!s3Ht.4,JX]Pn4{3d","type":"ColorDef"},{"name":"magenta","id":"P#0lFve(w}KW!j_+.q{w","type":"ColorDef"},{"name":"white","id":"a%.-R]L(`w^(o=AEt]K`","type":"ColorDef"},{"name":"none","id":"TFmFW?).wKf=+rwisHES","type":"ColorDef"},{"name":"dial","id":"A%Q4I{Fw1}[HZ25D/7sC","type":"Motor"},{"name":"inventor hub","id":"*5#BC_CDLI:7,Tq%_{#f","type":"InventorHub"},{"name":"start_driving","id":"NdzekE#*A-3^u{=XF,9y","type":"FunctionImported"},{"name":"play_sound","id":"InaCEX!Wvubx{)h9ua7L","type":"FunctionImported"},{"name":"DuploTrain","id":"Sffa}}200*Q_|`ua!5IE","type":"FunctionImported"},{"name":"set_light","id":"H)(CPxdW.NkK~=wz;ku{","type":"FunctionImported"},{"name":"get_color","id":"LB$!O#z=:D;Ve=[[[MyW","type":"FunctionImported"},{"name":"read","id":"w6|U{/Fa)FphL]lf]hAb","type":"FunctionImported"},{"name":"getColorCode","id":"QI($xQ`cv$LJ^6wuP.0G","type":"Function"},{"name":"last color","id":"TE4wo///`0hS0R{cxKph","type":"Any"},{"name":"train","id":"7)~un:z)5e}=.]Wk?bCp","type":"Any"},{"name":"last color code","id":"Et2W!b}zsYFYxI[Se.}N","type":"Any"},{"name":"current color code","id":"xrrSdt#dhf(z@N_OqNbl","type":"Any"},{"name":"duplo","id":"%]2OUS2}u#;!=@-Ac*wK","type":"ModuleImported"}],"info":{"type":"pybricks","version":"1.3.2"}}
from pybricks.hubs import InventorHub
from pybricks.parameters import Button, Color, Direction, Port
from pybricks.pupdevices import Motor
from pybricks.tools import wait

from duplo import DuploTrain, get_color, play_sound, read, set_light, start_driving

# Set up all devices.
inventor_hub = InventorHub()
dial = Motor(Port.A, Direction.CLOCKWISE)

# Initialize variables.
train = DuploTrain()
last_color_code = None
current_color_code = None

def getColorCode():
    global current_color_code, last_color_code
    # look for the color code
    # If you don't recognize it, reset to the old one
    # If it's the same as the old one don't do anything
    # If it's new then process it and update the old one
    current_color_code = get_color(train, True)
    if current_color_code == None:
        current_color_code = last_color_code
    elif current_color_code != last_color_code:
        if current_color_code == 'brightred':
            start_driving(train, 0)
            dial.reset_angle(0)
        last_color_code = current_color_code
    else:
        pass


# The main program starts here.
dial.reset_angle(0)
inventor_hub.system.set_stop_button(Button.BLUETOOTH)
while True:
    # Set the train speed based on the motor angle.
    start_driving(train, dial.angle())
    # Play a sound if the hub button is pressed.
    if Button.LEFT in inventor_hub.buttons.pressed():
        play_sound(train, 'depart')
        while Button.CENTER in inventor_hub.buttons.pressed():
            wait(0)
    if Button.RIGHT in inventor_hub.buttons.pressed():
        set_light(train, Color.RED)
    getColorCode()
